var z=typeof self==="object"&&self.self===self?self:typeof globalThis==="object"?globalThis:null;function l(p,A=150){let _,H=(...b)=>(clearTimeout(_),_=setTimeout(()=>p.apply(this,b),A));return H.cancel=()=>clearTimeout(_),H}var N=(p)=>p?.cancelable!==!1,W={pointerEvents:"PointerEvent"in z,touch:"ontouchstart"in z},R={pointer:{move:"pointermove",end:["pointerup","pointercancel","pointerleave"]},touch:{move:"touchmove",end:["touchend"]},mouse:{move:"mousemove",end:["mouseup","mouseleave"]}},o="cubic-bezier(0.25, 0.46, 0.45, 0.94)";function x(p,A={}){if(!p)return null;let _={speed:400,startSlide:0,draggable:!1,mousewheel:!0,disableScroll:!1,stopPropagation:!1,ignore:null,paused:!1,...A},H={},b={},a,r=parseInt(_.startSlide,10)||0,q=p.children[0];if(!q)return null;let g,C,k,M,K=(()=>{return z.getComputedStyle?.(p,null)?.getPropertyValue("direction")==="rtl"?"right":"left"})(),V=l(F,150),S=null,$=(h,u,s,L)=>_[h]?.(u,s,L),O={handleEvent(h){switch(h.type){case"pointerdown":this.onStart(h,h.clientX,h.clientY,h.pointerId);break;case"pointermove":if(h.isPrimary&&h.pointerId===H.pointerId)this.onMove(h,h.clientX,h.clientY);break;case"pointerup":case"pointercancel":case"pointerleave":this.onEnd(h,"pointer");break;case"touchstart":if(h.touches[0])this.onStart(h,h.touches[0].pageX,h.touches[0].pageY);break;case"touchmove":if(h.touches.length===1&&!(h.scale&&h.scale!==1))this.onMove(h,h.touches[0].pageX,h.touches[0].pageY);break;case"touchend":this.onEnd(h,"touch");break;case"mousedown":h.preventDefault(),this.onStart(h,h.pageX,h.pageY);break;case"mousemove":this.onMove(h,h.pageX,h.pageY);break;case"mouseup":case"mouseleave":this.onEnd(h,"mouse");break;case"transitionend":if(parseInt(h.target.getAttribute("data-index"),10)===r)$("transitionEnd",r,g[r]);break;case"resize":V();break;case"wheel":this.onWheel(h);break}if(_.stopPropagation)h.stopPropagation()},captured:!1,onStart(h,u,s,L){if(_.paused)return;if(h.type==="pointerdown"&&!h.isPrimary)return;if(_.ignore&&h.target.matches(_.ignore))return;H={x:u,y:s,time:Date.now(),pointerId:L},a=void 0,b={},this.captured=!1;let J=h.type==="pointerdown"?"pointer":h.type==="touchstart"?"touch":"mouse",U=R[J];q.addEventListener(U.move,this,{passive:!1}),U.end.forEach((X)=>q.addEventListener(X,this)),$("dragStart",r,g[r])},onMove(h,u,s){if(b={x:u-H.x,y:s-H.y},a===void 0){if(a=Math.abs(b.y)>Math.abs(b.x)+10,!a&&!this.captured&&h.type==="pointermove")q.setPointerCapture(h.pointerId),this.captured=!0}if(!a){if(N(h))h.preventDefault();$("runMove");let L=w(b.x);y(L)}else if(_.disableScroll&&N(h))h.preventDefault()},onEnd(h,u){if(u==="pointer"&&!h.isPrimary)return;if(this.captured)q.releasePointerCapture(h.pointerId),this.captured=!1;let s=R[u];q.removeEventListener(s.move,this),s.end.forEach((L)=>q.removeEventListener(L,this)),this.finishSwipe()},onWheel(h){if(_.paused)return;let{deltaX:u,deltaY:s}=h;if(h.deltaMode===1)u*=40,s*=40;else if(h.deltaMode===2)u*=k,s*=k;if(Math.abs(u)<3)return;if(N(h))h.preventDefault();if(!b.x)H.time=Date.now();let L=Math.abs(b.x||0),J=L>k*2?0.01:L>k*1.5?0.05:L>k?0.1:L>k*0.5?0.3:0.7;b={x:(b.x||0)-u*J,y:(b.y||0)-s*0.5};let U=w(b.x);if(y(U),S)clearTimeout(S);S=setTimeout(()=>{this.finishSwipe(),b={},S=null},50)},finishSwipe(){let h=Date.now()-H.time,u=Math.abs(b.x||0),s=h<250&&u>20||u>k/2,L=!r&&b.x>0||r===g.length-1&&b.x<0,J=b.x?Math.abs(b.x)/b.x:0;if(!a&&b.x)if(s&&!L){if(J<0)j(r-1,-k,0),j(r,C[r]-k,_.speed),j(I(r+1),C[I(r+1)]-k,_.speed),r=I(r+1);else j(r+1,k,0),j(r,C[r]+k,_.speed),j(I(r-1),C[I(r-1)]+k,_.speed),r=I(r-1);$("callback",r,g[r],J)}else j(r-1,-k,_.speed),j(r,0,_.speed),j(r+1,k,_.speed);$("dragEnd",r,g[r])}};function w(h){let u=!r&&h>0,s=r===g.length-1&&h<0;return u||s?h/(Math.abs(h)/k+1):h}function I(h){return(h+M)%M}function j(h,u,s){Q(h,u,s),C[h]=u}function Q(h,u,s){let L=g[h];if(!L?.style)return;L.style.transition=s?`transform ${s}ms ${o}`:"none",L.style.transform=`translate3d(${u}px, 0, 0)`}function y(h){Q(r-1,h+C[r-1],0),Q(r,h+C[r],0),Q(r+1,h+C[r+1],0)}function F(h){if(h)Object.assign(_,h);if(g=q.children,M=g.length,!M)return;k=p.clientWidth,C=Array(M),q.style.width=M*k*2+"px";for(let u=M-1;u>=0;u--){let s=g[u];if(s.style.willChange="transform",s.style.width=k+"px",s.setAttribute("data-index",u),s.style[K]=u*-k+"px",K==="right")s.style.float="right";let L=r>u?-k:r<u?k:0;j(u,L,0)}P(),m()}function m(){if([W.pointerEvents?"pointerdown":W.touch?"touchstart":null,_.draggable&&!W.pointerEvents?"mousedown":null,"transitionend"].filter(Boolean).forEach((u)=>q.addEventListener(u,O)),_.mousewheel)q.addEventListener("wheel",O,{passive:!1});z.addEventListener("resize",O)}function P(){let h=R,u=W.pointerEvents?["pointerdown",h.pointer.move,...h.pointer.end]:["touchstart",h.touch.move,...h.touch.end];u.push("mousedown",h.mouse.move,...h.mouse.end,"wheel","transitionend"),u.forEach((s)=>q.removeEventListener(s,O)),z.removeEventListener("resize",O)}let E=()=>r;function G(h,u){if(h=typeof h==="number"?h:parseInt(h,10),r===h)return;let s=Math.abs(r-h)/(r-h),L=Math.abs(r-h)-1;while(L--)j(I((h>r?h:r)-L-1),k*s,0);h=I(h),j(r,k*s,u??_.speed),j(h,0,u??_.speed),r=h,requestAnimationFrame(()=>{$("callback",r,g[r],s)})}function c(){G(r-1)}function D(){if(r<g.length-1)G(r+1)}function T(){q.style.width="",q.style[K]="";for(let h=g.length-1;h>=0;h--){let u=g[h];if(u.getAttribute("data-cloned")){u.parentElement?.removeChild(u);continue}u.style.width="",u.style[K]="",u.style.transitionDuration="",u.style.transform="",u.style.willChange=""}if(P(),V.cancel(),S)clearTimeout(S),S=null}return F(),{setup:F,slide:G,prev:c,next:D,getPos:E,getNumSlides:()=>M,setIndex:(h)=>r=h,appendSlide:(h)=>(q.appendChild(h),F()),prependSlide:(h)=>(q.prepend(h),r++,F()),pause:()=>_.paused=!0,resume:()=>_.paused=!1,kill:T}}var Y=x;var B="swipe-slider-wrapper",Z="data-cloned";class f extends HTMLElement{constructor(){super();this.swipe=null,this._n=0,this._loop=!1}connectedCallback(){this.init()}disconnectedCallback(){this.kill()}_call(p,A,_,...H){this.dispatchEvent(new CustomEvent(`swipe:${p}`,{detail:A,bubbles:!0})),_?.(...H)}_idx(p,A){return Number(p?.dataset?.logicalIndex??A)}_logicalIndex(p){if(!this._loop)return p;let A=this._n;return((p-2)%A+A)%A}_handleLoopJump(p){if(!this._loop||!this.swipe)return;let A=this._n,_=A+4,H=p<=1?p+A:p>=_-2?p-A:null;if(H!==null)this.swipe.setIndex(H),this.swipe.setup()}init(p={}){if(this.swipe)this.kill();let A={autoH:this.getAttribute("auto-height"),isLoop:this.hasAttribute("loop"),start:+(this.getAttribute("start-slide")||0),speed:+(this.getAttribute("speed")||400),draggable:this.hasAttribute("draggable"),mousewheel:!this.hasAttribute("no-mousewheel"),disableScroll:this.hasAttribute("disable-scroll"),stopPropagation:this.hasAttribute("stop-propagation"),passive:this.hasAttribute("passive-events")};this._loop=A.isLoop;let _={startSlide:A.start,speed:A.speed,draggable:A.draggable,mousewheel:A.mousewheel,disableScroll:A.disableScroll,stopPropagation:A.stopPropagation,passive:A.passive,...p,callback:(a,r,q)=>{if(A.autoH!==null)this.adjustHeight(r);this._call("change",{index:this._idx(r,a),element:r,direction:q},p.callback,a,r,q)},transitionEnd:(a,r)=>{this._handleLoopJump(a),this._call("transition-end",{index:this._idx(r,a),element:r},p.transitionEnd,a,r)},dragStart:(a,r)=>{this._call("drag-start",{index:this._idx(r,a),element:r},p.dragStart,a,r)},dragEnd:(a,r)=>{this._call("drag-end",{index:this._idx(r,a),element:r},p.dragEnd,a,r)},runMove:()=>{this._call("move",{},p.runMove)}},H=this.querySelector("."+B);if(!H){H=document.createElement("div"),H.className=B;let a=0;while(this.firstChild){let r=this.firstChild;r.dataset&&(r.dataset.logicalIndex=String(a++)),H.appendChild(r)}this.appendChild(H)}else H.querySelectorAll(`[${Z}]`).forEach((a)=>a.remove()),[...H.children].forEach((a,r)=>{a.dataset&&!a.dataset.logicalIndex&&(a.dataset.logicalIndex=String(r))});let b=[...H.children].filter((a)=>!a.hasAttribute(Z));if(this._n=b.length,A.isLoop&&b.length>=2){let a=b.length,r=[b[a-2],b[a-1],b[0],b[1]].map((q)=>{let g=q.cloneNode(!0);return g.setAttribute(Z,"true"),g});H.prepend(r[0],r[1]),H.append(r[2],r[3]),_.startSlide=A.start+2}requestAnimationFrame(()=>{if(this.swipe=new Y(this,_),A.autoH!==null){let a=this.swipe?.getPos();if(a!==void 0&&H.children[a])this.adjustHeight(H.children[a])}this.dataset.ready="true"})}adjustHeight(p){if(!p)return;let A=+(this.getAttribute("auto-height")||0);this.style.height=Math.max(p.offsetHeight,A)+"px"}slide(p,A){return this.swipe?.slide(this._loop?p+2:p,A)}prev(){return this.swipe?.prev()}next(){return this.swipe?.next()}getPos(){return this._logicalIndex(this.swipe?.getPos()??0)}getNumSlides(){return this._n}kill(){if(this.swipe)this.swipe.kill(),this.swipe=null;this.querySelector("."+B)?.querySelectorAll(`[${Z}]`).forEach((p)=>p.remove()),this._n=0,this._loop=!1,delete this.dataset.ready}setup(p){this.swipe?.setup(p)}appendSlide(p){this.swipe?.appendSlide(p)}prependSlide(p){this.swipe?.prependSlide(p)}}export{f as default};
